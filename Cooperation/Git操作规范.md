# Git操作规范> **Note:**> > * 本文中所有Git操作采用命令行描述，使用图形界面客户端的请自行根据自己的工具匹配相应的操作##Git分支管理> **Note:**> > * 因为Git是一个分布式版本控制系统，因此它并不存在一个绝对的中心库，但是在团队协作过程中我们需要指定一个**概念上的中心库**，通常我们将其命名为**origin**，每个人都从这个库获取最新代码，并将最终的修改提交到这个库。###主要分支我们需要在 origin 库保留两个生命周期无限期的主要分支：**master** 和 **develop*** origin/master：发布分支，该分支的代码对应线上版本，需要严格的管控，只有项目管理员可以提交该分支，其他成员仅有只读权限。通常在代码通过测试并需要发布线上时，由管理员将 origin/develop 分支的代码合并过来。* origin/develop：集成分支，所有 [支撑分支](#支撑分支) 上开发完成并通过自测的任务最终都要提交到develop分支，该分支的代码保持为最新状态。当 develop 分支上的内容达到一个稳定状态，则将其 merge 到 master 分支，并打一个版本号 Tag，**该操作由项目管理员执行，管理员有责任对 develop 分支的内容进行审核并确定合并到 master 的内容的安全和稳定性**。###支撑分支相对于上面提到的两个主要分支，支撑分支只具有短暂的生命周期，支撑分支均由 origin/develop 分支为基础创建，并在完成分支内的任务后将其删除。> **Notice:**>> * 所有进行中的任务都务必在支撑分支进行，不可以在 develop 分支直接开始和进行一个未完成的任务现将支撑分支规范为以下3个：* 新特性分支(Freature branches)：命名规则为新特性全称，比如：`wechat_pay`，用来进行新需求的开发。* BUG修复分支(Bugfix branches)：命名规则为`fix-*`(其中 * 号为 BUG 的 issue 编号)，用来进行 bug 的修复。* 发布分支(Release branches)：命名规则为`release-*`(其中 * 号为发布的版本号)，用来快速定位发布的版本。###操作流程####新需求任务* 创建分支于：develop* 合并分支回：develop* 分支命名：新特性全称Freature 分支用户开发新特性，通常不需要提交到 origin，只在开发者本地的库中创建即可，开发者完成开发并通过测试后将 feature 分支 merge 到 develop 分支，然后删除该 feature 分支。示例```# 1. 新建并切换到 newfeature 分支$ git checkout -b newfeature develop# 2. 进行相关开发和测试工作，commit代码...coding...# 3. 完成后，切换回 develop 分支$ git checkout develop# 4. 将 newfeature 中完成的内容合并回 develop 分支$ git merge --no-ff newfeature# 5. 删除 newfeature 分支$ git branch -d newfeature# 6. 将代码提交到 origin 中心库$ git push origin develop```> **Note:**> > * merge 时要添加 **--no-ff** 参数。因为 git 缺省的 merge 快进机制有时会造成部分有用的提交信息丢失，而 --no-ff 参数可以强制使 merge 产生一个新的 commit，从而确保 merge 进来的全部历史记录的完整性。#### BUG修复* 创建分支于：发现 bug 的分支* 合并分支回：develop，需要时由管理员合并到 master* 分支命名：fix-*（ \* 为 Bug Issue 编号）Bugfix 分支的特点是对已提交任务的 Bug 进行修复，并重新提交。示例```# 1.创建并切换到 fix-121 分支$ git checkout -b fix-121 master# 2.修改版本相关元数据...coding...# 3.提交修改$ git commit -m "Fixed bla bla bla problem"# 4.切换回 develop 分支$ git checkout develop# 5.合并修改$ git merge --no-ff fix-121# 6.切换到 master 分支$ git checkout master# 7.合并修改(仅管理员有权限)$ git merge --no-ff develop# 8.删除 fix 分支$ git branch -d fix-121```> **Notice:**> > * 假如修改 Bug 时有新的 Release 分支尚未发布，则应将该 hotfix 分支 merge 到 release 分支一并发布####版本发布* 创建分支于：master* 合并分支回：无需合并* 分支命名：release-*（ \* 为版本号）Release 分支可以在发布后的未来时间随时针对一个特定的版本进行 Bug 修复，并可在预先规划的情况下对某个发布的版本包含特定的新 Feature。示例```# 1.切换到一个新分支 release-1.2$ git checkout -b release-1.2 master# 2.切换回 master 分支$ git checkout master# 3.打版本标签$ git tag -a 1.2```## 常见操作规则###多用fetch 少用pullTODO###正确使用.gitignoreTODO  